#/usr/bin/env bash
cd $(dirname $0)/..
set -e
# Clear screen
echo "\x1b[2J\x1b[3J\x1b[H"

RUNTIME=runtime
OUTPUT_DIR=./build

node ./scripts/compile.mjs "./src/$RUNTIME.wat" > "$OUTPUT_DIR/$RUNTIME.build.wat"
wat2wasm "$OUTPUT_DIR/$RUNTIME.build.wat" --debug-names --output "$OUTPUT_DIR/$RUNTIME.wasm"
echo "Compiled $OUTPUT_DIR/$RUNTIME.wasm"
